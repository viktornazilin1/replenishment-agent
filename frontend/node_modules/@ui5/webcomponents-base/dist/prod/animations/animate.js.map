{
  "version": 3,
  "sources": ["../../../src/animations/animate.ts"],
  "sourcesContent": ["import AnimationQueue from \"./AnimationQueue.js\";\n\ntype AnimateOptions = {\n\tbeforeStart?: () => void,\n\tduration: number,\n\telement: HTMLElement,\n\tadvance: (p: number) => void,\n};\n\nconst animate = (options: AnimateOptions) => {\n\tlet start: number | null = null;\n\tlet stopped = false;\n\tlet animationFrame: number;\n\tlet stop: () => void;\n\tlet advanceAnimation: (timestamp: number) => void;\n\n\tconst promise = new Promise<void>((resolve, reject) => {\n\t\tadvanceAnimation = timestamp => {\n\t\t\tstart = start || timestamp;\n\n\t\t\tconst timeElapsed = timestamp - start;\n\t\t\tconst remaining = options.duration - timeElapsed;\n\n\t\t\tif (timeElapsed <= options.duration) {\n\t\t\t\tconst currentAdvance = 1 - remaining / options.duration; // easing formula (currently linear)\n\t\t\t\toptions.advance(currentAdvance);\n\t\t\t\tif (!stopped) {\n\t\t\t\t\tanimationFrame = requestAnimationFrame(advanceAnimation);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toptions.advance(1);\n\t\t\t\tresolve();\n\t\t\t}\n\t\t};\n\n\t\tstop = () => {\n\t\t\tstopped = true;\n\t\t\tcancelAnimationFrame(animationFrame);\n\t\t\treject(new Error(\"animation stopped\"));\n\t\t};\n\t}).catch((reason: Error) => reason);\n\n\tAnimationQueue.push(options.element, () => {\n\t\tif (typeof options.beforeStart === \"function\") {\n\t\t\toptions.beforeStart();\n\t\t}\n\n\t\trequestAnimationFrame(advanceAnimation);\n\n\t\treturn new Promise(resolve => {\n\t\t\tpromise.then(() => resolve());\n\t\t});\n\t});\n\n\treturn {\n\t\tpromise: () => promise,\n\t\tstop: () => stop,\n\t};\n};\nconst duration = 400;\n\nexport { duration };\nexport type { AnimateOptions };\nexport default animate;\n"],
  "mappings": "aAAA,OAAOA,MAAoB,sBAS3B,MAAMC,EAAWC,GAA4B,CAC5C,IAAIC,EAAuB,KACvBC,EAAU,GACVC,EACAC,EACAC,EAEJ,MAAMC,EAAU,IAAI,QAAc,CAACC,EAASC,IAAW,CACtDH,EAAmBI,GAAa,CAC/BR,EAAQA,GAASQ,EAEjB,MAAMC,EAAcD,EAAYR,EAC1BU,EAAYX,EAAQ,SAAWU,EAErC,GAAIA,GAAeV,EAAQ,SAAU,CACpC,MAAMY,EAAiB,EAAID,EAAYX,EAAQ,SAC/CA,EAAQ,QAAQY,CAAc,EACzBV,IACJC,EAAiB,sBAAsBE,CAAgB,EAEzD,MACCL,EAAQ,QAAQ,CAAC,EACjBO,EAAQ,CAEV,EAEAH,EAAO,IAAM,CACZF,EAAU,GACV,qBAAqBC,CAAc,EACnCK,EAAO,IAAI,MAAM,mBAAmB,CAAC,CACtC,CACD,CAAC,EAAE,MAAOK,GAAkBA,CAAM,EAElC,OAAAf,EAAe,KAAKE,EAAQ,QAAS,KAChC,OAAOA,EAAQ,aAAgB,YAClCA,EAAQ,YAAY,EAGrB,sBAAsBK,CAAgB,EAE/B,IAAI,QAAQE,GAAW,CAC7BD,EAAQ,KAAK,IAAMC,EAAQ,CAAC,CAC7B,CAAC,EACD,EAEM,CACN,QAAS,IAAMD,EACf,KAAM,IAAMF,CACb,CACD,EACMU,EAAW,IAEjB,OAASA,KAAA,UAET,eAAef",
  "names": ["AnimationQueue", "animate", "options", "start", "stopped", "animationFrame", "stop", "advanceAnimation", "promise", "resolve", "reject", "timestamp", "timeElapsed", "remaining", "currentAdvance", "reason", "duration"]
}
